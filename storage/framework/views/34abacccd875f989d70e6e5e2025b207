<?php $__env->startSection('content'); ?>
<body ng-controller="barangController">
Notifikasi
<div id="notifications"></div>

<section class="content">
<div class="box box-primary">

<div class="box-header"></div>   
<!-- Button trigger modal -->
<div class="box-body pad table-responsive">

<div class="col-md-12">
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal"><i class="fa fa-plus"></i>
  Tambah Barang 
</button>
              <div class="box">
                <div class="box-header with-border">
                  <h3 class="box-title">Data Barang</h3>
                </div><!-- /.box-header -->
                <div class="box-body">
                  <table class="table table-bordered">
                    <tbody><tr>
                      <th>Kode Barang</th>
                      <th>Nama Barang</th>
                      <th>Harga</th>
                      <th>Jumlah</th>      
                    </tr>
                    
                
                    <tr ng-repeat="barang in datas">
                      <td><% barang.idBarang %></td>
                      <td><% barang.namaBarang %></td>
                      <td><% barang.hargaBarang %></td>
                      <td><% barang.jumlahBarang %></td>
               
                    </tr>                    
                  </tbody></table>
                </div><!-- /.box-body -->
                <div class="box-footer clearfix">
                  <ul class="pagination pagination-sm no-margin pull-right">
                    <li><a href="#">«</a></li>
                    <li><a href="#">1</a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">3</a></li>
                    <li><a href="#">»</a></li>
                  </ul>
                </div>
              </div><!-- /.box -->          
            </div>


</div>
</div>

</div>
</section>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>

      <div class="col-md-9">
      <div class="modal-body">
        
        <?php echo Form::open(['ng-submit'=>'addBarang($event)','class'=>'form-horizontal']); ?>

          <?php echo csrf_field(); ?>


      <div class="form-group">
      
      <div class="col-lg-6">
      <label for="">Kode Barang :</label>
            <?php echo Form::text('idBarang',$kodeBarang,array('class'=>'form-control ','disabled','ng-model'=>'idBarang','ng-init'=>"idBarang='$kodeBarang'")); ?>

            <input type="hidden" ng-model="idBarang" value="<?php echo $kodeBarang; ?>" ng-init="idBarang='<?php echo $kodeBarang; ?>'">         
        </div>    
      </div>

      <div class="form-group" id="formNama">
        <div>  
          <label id="label">Nama Barang :</label>    
          <?php echo Form::text('namaBarang',null,array('class'=>'form-control','ng-model'=>'namaBarang')); ?><label id="vNama"></label>
        </div>
      </div>

      <div class="form-group" id="formJml">
        <label id="label">Jumlah Barang :</label>    
        <div>
          <?php echo Form::text('jumlahBarang',null,array('class'=>'form-control','ng-model'=>'jumlahBarang','numbers-only'=>'numbers-only')); ?><label id="vJumlah"></label>
        </div>
      </div>

      <div class="form-group" id="formHrg">
        <label id="label">Harga Barang :</label>    
          <div class="input-group">
        <span class="input-group-addon">Rp</span>
            <?php echo Form::text('hargaBarang',null,array('class'=>'form-control','ng-model'=>'hargaBarang','numbers-only'=>'numbers-only')); ?>

        </div>
        <label id="vHarga"></label>
      </div>    
        <br>
        <button type="button" class="btn btn-default" data-dismiss="modal">Batal</button>
             <button type="submit" class="btn btn-primary"  >Simpan</button>
    
    <?php echo Form::close(); ?>

    </div>
      </div>

    
      <div class="modal-footer">
   
      </div>
   
    </div>
  </div>
</div>
</body>
<script src="<?php echo e(asset('/lib/angular/angular.min.js')); ?>" type="text/javascript"></script>
<script src="<?php echo asset('lib/socket.io.js'); ?>"></script>
<script src="<?php echo e(asset('/controller/barangController.js')); ?>"></script> 
<script>
  var socket = io('http://localhost:9090');

  socket.on('barang_registration', function (data) {

    console.log(data);

    var barang = data.barang;

	var i;
	for (i = 0; i < barang.length; i++) {
	    var msg_count = 0;
    var act = document.getElementById('notifications');
    var date = new Date();
    var log = document.createElement('div');
    log.innerHTML = date.getTime() + ': ' + barang[i].namaBarang + '(' + barang[i].hargaBarang + ') telah terdafar.';
    act.appendChild(log);
	}

	  var act = document.getElementById('message');
    var log = document.createElement('div');
    act.innerHTML = "<span class='label label-danger'>"+ barang.length +"</span>"
    act.appendChild(log);

    var act = document.getElementById('jumlah');
    var log = document.createElement('div');
    act.innerHTML =  barang.length +" Barang,Stok Kurang";
    act.appendChild(log);

// 

    for (i = 0; i < barang.length; i++) {
    var act = document.getElementById('list_barang');
    var log = document.createElement('div');
    log.innerHTML="<li><a href='#'>"+barang[i].namaBarang+" <small class='pull-right'> Jumlah barang :"+barang[i].jumlahBarang+"</small></a></li>";
    act.appendChild(log);
  }


  


  });


</script>



<?php $__env->stopSection(); ?>




<?php echo $__env->make('layout.master', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>